# üß± –ò—Ç–µ—Ä–∞—Ü–∏—è 2: –ö–ª–∞—Å—Å—ã, –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä—ã –∏ `runTestClass()`

–ü–æ—Å–ª–µ —Ç–æ–≥–æ –∫–∞–∫ –º—ã –ø–æ–ª—É—á–∏–ª–∏ —á–∏—Ç–∞–µ–º—ã–π `testCase()` –≤ –ø–µ—Ä–≤–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏, —Å—Ç–∞–ª–æ –ø–æ–Ω—è—Ç–Ω–æ, —á—Ç–æ **—Ç–µ—Å—Ç—ã –Ω—É–∂–Ω–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞—Ç—å**.  
–í —ç—Ç–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏ –º—ã –¥–æ–±–∞–≤–∏–º –ø–æ–¥–¥–µ—Ä–∂–∫—É **–∫–ª–∞—Å—Å-–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã**, –≤–¥–æ—Ö–Ω–æ–≤–ª—ë–Ω–Ω–æ–π –ø–æ–¥—Ö–æ–¥–∞–º–∏ –∏–∑ NestJS, Playwright –∏ BDD.

---

## üß© –¶–µ–ª—å

- –°–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å —Ç–µ—Å—Ç—ã –ø–æ –∫–ª–∞—Å—Å–∞–º
- –î–æ–±–∞–≤–∏—Ç—å `@TestCase()` –¥–ª—è –º–µ—Ç–æ–¥–∞
- –î–æ–±–∞–≤–∏—Ç—å `@Feature()` –¥–ª—è –∫–ª–∞—Å—Å–∞
- –ü–æ–¥–¥–µ—Ä–∂–∞—Ç—å `runTestClass()` ‚Äî –∫–æ—Ç–æ—Ä—ã–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–∑–æ–≤–µ—Ç `vitest.test(...)` —Å –Ω—É–∂–Ω—ã–º–∏ –º–µ—Ç–∫–∞–º–∏

---

## üì¶ –ü—Ä–∏–º–µ—Ä: —á–∏—Ç–∞–µ–º—ã–π –∫–ª–∞—Å—Å —Å —Ç—Ä–µ–º—è –∫–µ–π—Å–∞–º–∏

```ts
@Feature('–ü—Ä–æ—Ñ–∏–ª—å')
class ProfileTests {
  @TestCase('–ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è', {
    id: 'API-CLASS-01',
    severity: 'critical',
  })
  async getProfile() {
    await step('GET /users/1', async () => {
      const response = await axios.get('https://jsonplaceholder.typicode.com/users/1')
      attach('–û—Ç–≤–µ—Ç JSON', response.data, 'application/json')
      if (response.data.username !== 'Bret') {
        throw new Error(`–û–∂–∏–¥–∞–ª—Å—è username = Bret, –∞ –ø–æ–ª—É—á–µ–Ω ${response.data.username}`)
      }
    })
  }

  @TestCase('–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π', {
    id: 'API-CLASS-02',
    severity: 'normal',
  })
  async getUsersList() {
    await step('GET /users', async () => {
      const res = await axios.get('https://jsonplaceholder.typicode.com/users')
      attach('–°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π', res.data)
      if (!Array.isArray(res.data)) throw new Error('–û–∂–∏–¥–∞–ª—Å—è –º–∞—Å—Å–∏–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π')
    })
  }

  @TestCase('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è', {
    id: 'API-CLASS-03',
    severity: 'minor',
  })
  async getInvalidUser() {
    await step('GET /users/9999', async () => {
      try {
        await axios.get('https://jsonplaceholder.typicode.com/users/9999')
        throw new Error('–û–∂–∏–¥–∞–ª—Å—è 404, –Ω–æ –æ—Ç–≤–µ—Ç —É—Å–ø–µ—à–µ–Ω')
      } catch (error: any) {
        attach('–û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞', error.toJSON?.() || error.message)
        if (!error.response || error.response.status !== 404) {
          throw new Error('–û–∂–∏–¥–∞–ª—Å—è —Å—Ç–∞—Ç—É—Å 404')
        }
      }
    })
  }
}

runTestClass(ProfileTests)
```

---

## ‚öôÔ∏è –ü–æ–¥ –∫–∞–ø–æ—Ç–æ–º

```ts
// @TestCase
Reflect.defineMetadata(TEST_CASES_KEY, [...], target)
// @Feature
Reflect.defineMetadata(FEATURE_KEY, name, target.prototype)

// runTestClass
test(meta.name, async () => {
  await allure.feature(...)
  await allure.label(...)
  await allure.step(..., () => instance[method]())
})
```

---

## üí° –ü–æ—á–µ–º—É —ç—Ç–æ –≤–∞–∂–Ω–æ

- –¢–µ—Å—Ç—ã —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä—É—é—Ç—Å—è –ø–æ –º–æ–¥—É–ª—è–º (Profile, Auth –∏ —Ç.–¥.)
- –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è –¥–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω—ã–º–∏
- –í—Å—ë —á–∏—Ç–∞–µ–º–æ, –ø–æ–≤—Ç–æ—Ä–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º–æ –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ
- –í–æ–∑–º–æ–∂–Ω–∞ –¥–∞–ª—å–Ω–µ–π—à–∞—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ `@BeforeEachCase()`, `@Suite()`, –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–∞—Ü–∏—é

---

## üß† –ü–æ–¥–≤–æ–¥–Ω—ã–π –∫–∞–º–µ–Ω—å: –≤–ª–æ–∂–µ–Ω–∏—è –≤–Ω–µ `step`

> –ï—Å–ª–∏ `attach()` –∏–ª–∏ `label()` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –≤–Ω–µ `step(...)`, –æ–Ω–∏ –Ω–µ –ø–æ–ø–∞–¥–∞—é—Ç –≤ —à–∞–≥ –≤ Allure.

–†–µ—à–µ–Ω–∏–µ: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `attach()` **–≤–Ω—É—Ç—Ä–∏ `step()`** ‚Äî —Ç–æ–≥–¥–∞ –≤—Å—ë –±—É–¥–µ—Ç –∫—Ä–∞—Å–∏–≤–æ.

---

## ‚úÖ –ò—Ç–æ–≥

–í —ç—Ç–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏ –º—ã –≤—ã—à–ª–∏ –Ω–∞ –Ω–æ–≤—ã–π —É—Ä–æ–≤–µ–Ω—å —á–∏—Ç–∞–µ–º–æ—Å—Ç–∏ –∏ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏:

- `ProfileTests` —Å—Ç–∞–ª –ª–æ–≥–∏—á–µ—Å–∫–∏–º –±–ª–æ–∫–æ–º
- –ö–∞–∂–¥—ã–π `@TestCase` ‚Äî —ç—Ç–æ —Å—Ü–µ–Ω–∞—Ä–∏–π
- –í—Å—ë —ç—Ç–æ –æ—Å—Ç–∞—ë—Ç—Å—è –≤ TypeScript, –±–µ–∑ `Given-When-Then`

–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥: **–ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–∞—Ü–∏—è –∏ data-driven –ø–æ–¥—Ö–æ–¥**
