# –ò—Ç–µ—Ä–∞—Ü–∏—è 2: –ö–ª–∞—Å—Å—ã, –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä—ã –∏ `runTestClass()`

## üéØ –¶–µ–ª—å

–ü–µ—Ä–µ–≤–µ—Å—Ç–∏ —Ç–µ—Å—Ç—ã –∏–∑ —Ñ—É–Ω–∫—Ü–∏–π –≤ **—Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–ª–∞—Å—Å—ã**, —á—Ç–æ–±—ã:
- —Å–æ–∫—Ä–∞—Ç–∏—Ç—å –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —à–∞–≥–æ–≤
- –ø–æ–≤—ã—Å–∏—Ç—å —á–∏—Ç–∞–µ–º–æ—Å—Ç—å
- –æ–±–µ—Å–ø–µ—á–∏—Ç—å –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É

---

## ü§î –ü—Ä–æ–±–ª–µ–º–∞

–í –ø—Ä–æ—à–ª–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏ –º—ã –ø–∏—Å–∞–ª–∏ —Ç–µ—Å—Ç—ã –≤ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–º —Å—Ç–∏–ª–µ:

```ts
testCase('–ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è', async () => {
  const res = await step('GET /profile', () => api.getProfile())
  attach('–û—Ç–≤–µ—Ç', res.data)
  expect(res.status).toBe(200)
})
```

–≠—Ç–æ —á–∏—Ç–∞–µ–º–æ, –Ω–æ –±—ã—Å—Ç—Ä–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—é –ª–æ–≥–∏–∫–∏ ‚Äî –æ—Å–æ–±–µ–Ω–Ω–æ –µ—Å–ª–∏ –≤ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –º–Ω–æ–≥–æ —à–∞–≥–æ–≤ –∏–ª–∏ —Ç–µ—Å—Ç–æ–≤ –Ω–µ—Å–∫–æ–ª—å–∫–æ.

–ù–∞–º –Ω—É–∂–Ω–æ:
- –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `this.ctx`
- —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞—Ç—å —à–∞–≥–∏ –∫–∞–∫ –º–µ—Ç–æ–¥—ã
- —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å —Ç–µ—Å—Ç—ã –ø–æ –∫–ª–∞—Å—Å–∞–º –∏ feature

---

## ‚úÖ –†–µ—à–µ–Ω–∏–µ ‚Äî –ø–µ—Ä–µ–π—Ç–∏ –∫ –∫–ª–∞—Å—Å–∞–º

–° –ø–æ–º–æ—â—å—é –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä–æ–≤ `@Feature`, `@TestCase`, `@Severity` –∏ `runTestClass()` –º—ã –ø—Ä–µ–≤—Ä–∞—â–∞–µ–º –∫–∞–∂–¥—ã–π —Ç–µ—Å—Ç –≤ –º–µ—Ç–æ–¥, –∞ –≤–µ—Å—å —Å—Ü–µ–Ω–∞—Ä–∏–π ‚Äî –≤ –∫–ª–∞—Å—Å.

```ts
@Feature('–ü—Ä–æ—Ñ–∏–ª—å')
class ProfileTest {
  @TestCase('–ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è', { id: 'API-102', severity: 'critical' })
  async testProfile() {
    const res = await step('GET /profile', () => api.getProfile())
    attach('–û—Ç–≤–µ—Ç', res.data)
    expect(res.status).toBe(200)
  }
}

runTestClass(ProfileTest)
```

---

## üîß –ß—Ç–æ —Å–¥–µ–ª–∞–ª–∏

- –°–æ–∑–¥–∞–ª–∏ –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä `@TestCase(name, meta)` –¥–ª—è –º–µ—Ç–æ–¥–∞
- –î–æ–±–∞–≤–∏–ª–∏ `@Feature` –∏ `@Severity`
- –ù–∞–ø–∏—Å–∞–ª–∏ `runTestClass()` ‚Äî –∞–¥–∞–ø—Ç–µ—Ä, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç –≤—Å–µ –º–µ—Ç–æ–¥—ã –≤ `test()`

```ts
export function runTestClass(clazz) {
  const instance = new clazz()
  const proto = Object.getPrototypeOf(instance)

  for (const key of Object.getOwnPropertyNames(proto)) {
    const method = proto[key]
    const meta = Reflect.getMetadata('testcase', instance, key)

    if (typeof method === 'function' && meta) {
      test(meta.name, async () => {
        if (meta.id) await label('AS_ID', meta.id)
        if (meta.severity) await severity(meta.severity)
        await method.call(instance)
      })
    }
  }
}
```

---

## üìö –ü—Ä–∏–º–µ—Ä –≤ —Å—Ç–∏–ª–µ Scenax

```ts
@Feature('–ü—Ä–æ—Ñ–∏–ª—å')
class ProfileTest {
  @TestCase('–ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è', { id: 'API-103', severity: 'normal' })
  async checkName() {
    const res = await step('GET /profile', () => api.getProfile())
    expect(res.data.name).toBe('–ò–≤–∞–Ω')
  }

  @TestCase('–ü—Ä–æ–≤–µ—Ä–∫–∞ email')
  async checkEmail() {
    const res = await step('GET /profile', () => api.getProfile())
    expect(res.data.email).toMatch(/@example\.com/)
  }
}

runTestClass(ProfileTest)
```

---

## üß© –ß—Ç–æ —Ç–∞–∫–æ–µ –∫–ª–∞—Å—Å –≤ Scenax?

–ö–ª–∞—Å—Å –≤ `Scenax` ‚Äî —ç—Ç–æ **–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–∞—è –µ–¥–∏–Ω–∏—Ü–∞**, –æ–ø–∏—Å—ã–≤–∞—é—â–∞—è —Ç–µ—Å—Ç–∏—Ä—É–µ–º—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π –Ω–∞ —É—Ä–æ–≤–Ω–µ **–±–∏–∑–Ω–µ—Å-—Ñ–∏—á–∏** –∏–ª–∏ **–∫–æ–Ω—Ç–µ–∫—Å—Ç–∞**.

–í —Ç–µ—Ä–º–∏–Ω–∞—Ö –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:

- –≠—Ç–æ **–Ω–µ –ø—Ä–æ—Å—Ç–æ –Ω–∞–±–æ—Ä –º–µ—Ç–æ–¥–æ–≤** ‚Äî —ç—Ç–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –Ω–∞–º–µ—Ä–µ–Ω–∏—è
- –û–Ω –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç —Ç–µ—Å—Ç-–∫–µ–π—Å—ã –ø–æ –ª–æ–≥–∏–∫–µ, –∞ –Ω–µ –ø–æ —Ç–∏–ø—É
- –û–Ω —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –µ–¥–∏–Ω–∏—Ü–µ–π –≤ Allure-–æ—Ç—á—ë—Ç–µ, –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ

### ‚ú≥Ô∏è –§–∏—á–∞ –∏–ª–∏ —Å—É—â–Ω–æ—Å—Ç—å?

–ß–∞—â–µ –≤—Å–µ–≥–æ ‚Äî **—Å—É—â–Ω–æ—Å—Ç—å**, –Ω–∞–ø—Ä–∏–º–µ—Ä: `ProfileTest`, `AuthFlow`, `PaymentChecks`.  
–ù–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –∏ **–ª–æ–≥–∏—á–µ—Å–∫–∞—è –≥—Ä—É–ø–ø–∞ —Ç–µ—Å—Ç–æ–≤**: `RegressionSuite`, `MobileAPITests`, `UnauthorizedFlows`.

---

### üîß –ß—Ç–æ –º–æ–∂–Ω–æ –ø–æ–≤–µ—Å–∏—Ç—å –Ω–∞ –∫–ª–∞—Å—Å?

| –î–µ–∫–æ—Ä–∞—Ç–æ—Ä          | –ì–¥–µ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è  | –ß—Ç–æ –∑–∞–¥–∞—ë—Ç                                  |
|---------------------|------------------|----------------------------------------------|
| `@Feature('Profile')`     | –Ω–∞ –∫–ª–∞—Å—Å        | –ù–∞–∑–≤–∞–Ω–∏–µ –±–∏–∑–Ω–µ—Å-—Ñ–∏—á–∏                         |
| `@Suite('API')`           | –Ω–∞ –∫–ª–∞—Å—Å        | –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –≤ Allure                        |
| `@ParentSuite('E2E')`     | –Ω–∞ –∫–ª–∞—Å—Å        | –ö–∞—Ç–µ–≥–æ—Ä–∏—è (UI, e2e, regression –∏ —Ç.–ø.)      |
| `@Layer('e2e')`           | –Ω–∞ –∫–ª–∞—Å—Å        | –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–π —Å–ª–æ–π                          |
| `@Context()`              | –Ω–∞ –ø–æ–ª–µ         | –ü–µ—Ä–µ–¥–∞—ë—Ç shared state –¥–ª—è –≤—Å–µ—Ö –º–µ—Ç–æ–¥–æ–≤      |
| `@Inject()`               | –Ω–∞ –ø–æ–ª–µ         | –í–Ω–µ–¥—Ä—è–µ—Ç –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ step-–∫–ª–∞—Å—Å—ã        |

---

### üì¶ –ö–ª–∞—Å—Å ‚Äî —ç—Ç–æ:

- ‚úÖ **–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä —Ç–µ—Å—Ç–æ–≤** —Å –µ–¥–∏–Ω—ã–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º
- ‚úÖ **–ù–µ–π–º—Å–ø–µ–π—Å**, –≥–¥–µ –º–æ–∂–Ω–æ —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ –∑–∞–¥–∞—Ç—å `Feature`, `Suite`, `Layer`
- ‚úÖ **–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞** –¥–ª—è Lifecycle-—Ö—É–∫–æ–≤ (`@BeforeAll`, `@Setup`, `@Teardown`)
- ‚úÖ **–ï–¥–∏–Ω–∏—Ü–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏**, –∫–æ—Ç–æ—Ä–∞—è –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ Allure –∫–∞–∫ –º–æ–¥—É–ª—å

> üí° –ö–ª–∞—Å—Å –¥–µ–ª–∞–µ—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É —Ç–µ—Å—Ç–æ–≤ —è–≤–Ω–æ–π, –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ–π –∏ —Ä–∞—Å—à–∏—Ä—è–µ–º–æ–π


## üß† –ü–æ—á–µ–º—É –∫–ª–∞—Å—Å—ã?

- ‚úÖ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —à–∞—Ä–∏—Ç—å `this.ctx`, `this.client`, `this.steps`
- ‚úÖ –õ–µ–≥–∫–æ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å —Ç–µ—Å—Ç—ã –ø–æ —Å—É—â–Ω–æ—Å—Ç–∏ (`@Feature('Profile')`)
- ‚úÖ –ú–æ–∂–Ω–æ –ø–æ–¥–∫–ª—é—á–∏—Ç—å lifecycle (`@BeforeAll`, `@Setup`, `@Teardown`)
- ‚úÖ –ü—Ä–∏–≤—ã—á–Ω–æ –¥–ª—è backend-—Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä–æ–≤

> –ú—ã –Ω–µ –∑–∞–º–µ–Ω—è–µ–º Vitest. –ú—ã –æ–ø–∏—Å—ã–≤–∞–µ–º –Ω–∞–º–µ—Ä–µ–Ω–∏—è –≤ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ–π —Ñ–æ—Ä–º–µ.

---

## üìà –ß—Ç–æ —ç—Ç–æ –¥–∞—ë—Ç –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ

| –ë—ã–ª–æ                         | –°—Ç–∞–ª–æ                           |
|------------------------------|----------------------------------|
| `testCase(name, fn)`         | `@TestCase()` –Ω–∞–¥ –º–µ—Ç–æ–¥–æ–º        |
| –ú–µ—Ç–∫–∏ –≤–Ω—É—Ç—Ä–∏ —Ç–µ–ª–∞ —Ç–µ—Å—Ç–∞      | –î–µ–∫–æ—Ä–∞—Ç–æ—Ä—ã –Ω–∞–¥ –º–µ—Ç–æ–¥–æ–º/–∫–ª–∞—Å—Å–æ–º   |
| –û–¥–∏–Ω —Ç–µ—Å—Ç = –æ–¥–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è     | –û–¥–∏–Ω —Å—Ü–µ–Ω–∞—Ä–∏–π = –æ–¥–∏–Ω –∫–ª–∞—Å—Å       |
| –ù–µ—Ç –æ–±—â–µ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞         | `this.ctx`, `this.steps`, –∏ –¥—Ä.  |

---

## üîú –ß—Ç–æ –¥–∞–ª—å—à–µ

–í —Å–ª–µ–¥—É—é—â–µ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏ ‚Äî —Å–¥–µ–ª–∞–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–∞—Ü–∏—é —Ç–µ—Å—Ç–æ–≤ —á–µ—Ä–µ–∑ `@TestCase.each()` –∏ —Å–æ–∑–¥–∞–¥–∏–º –ø–µ—Ä–≤—É—é –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—É—é data-driven —Å—Ç—Ä—É–∫—Ç—É—Ä—É.

‚û°Ô∏è –ö –æ–¥–Ω–æ–º—É —Å—Ü–µ–Ω–∞—Ä–∏—é ‚Äî –º–Ω–æ–≥–æ –≤—Ö–æ–¥–æ–≤. –ú–Ω–æ–≥–æ –¥–∞–Ω–Ω—ã—Ö. –û–¥–∏–Ω —Å—Ç–∏–ª—å.

